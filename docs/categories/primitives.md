---
layout: default
title: '‚è≥ –ö–∞–∫–∏–µ –±—ã–≤–∞—é—Ç –ø—Ä–∏–º–∏—Ç–∏–≤—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ .NET?'
description: ''
author: 'Dvurechensky'
date: 2025-08-28
published: true
tags:
  - primitives
  - C#
---

<p align="center">
    <a href="https://git.io/typing-svg"><img src="https://readme-typing-svg.demolab.com?font=Fira+Code&pause=1000&center=true&vCenter=true&width=435&lines=%D0%9F%D0%BE%D0%B2%D1%82%D0%BE%D1%80%D0%B5%D0%BD%D0%B8%D0%B5+-+%D0%BC%D0%B0%D1%82%D1%8C+%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D1%8F" alt="Typing SVG" /></a>
</p>
<p align="center">
    <a href="https://sites.google.com/view/dvurechensky" target="_blank"><img alt="Static Badge" src="https://shields.dvurechensky.pro/badge/Dvurechensky-Nikolay-blue"></a>
</p>

# ‚ú® –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [‚ú® –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ](#-–æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ)
  - [1Ô∏è‚É£ –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è](#1Ô∏è‚É£-–æ—Å–Ω–æ–≤–Ω–∞—è-–∏–¥–µ—è)
  - [2Ô∏è‚É£ `lock` (Monitor)](#2Ô∏è‚É£-lock-monitor)
  - [3Ô∏è‚É£ `Mutex` (System.Threading.Mutex)](#3Ô∏è‚É£-mutex-systemthreadingmutex)
  - [4Ô∏è‚É£ `Semaphore` –∏ `SemaphoreSlim`](#4Ô∏è‚É£-semaphore-–∏-semaphoreslim)
    - [Semaphore](#semaphore)
    - [SemaphoreSlim](#semaphoreslim)
  - [5Ô∏è‚É£ `AutoResetEvent` –∏ `ManualResetEvent`](#5Ô∏è‚É£-autoresetevent-–∏-manualresetevent)
  - [6Ô∏è‚É£ `Monitor.Wait()` / `Monitor.Pulse()` / `PulseAll()`](#6Ô∏è‚É£-monitorwait--monitorpulse--pulseall)
  - [7Ô∏è‚É£ ReaderWriterLockSlim](#7Ô∏è‚É£-readerwriterlockslim)
  - [8Ô∏è‚É£ Interlocked](#8Ô∏è‚É£-interlocked)
  - [9Ô∏è‚É£ –ö–∞–≤–µ—Ä–∑–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏ –ø–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏](#9Ô∏è‚É£-–∫–∞–≤–µ—Ä–∑–Ω—ã–µ-–º–æ–º–µ–Ω—Ç—ã-–∏-–ø–æ–¥–≤–æ–¥–Ω—ã–µ-–∫–∞–º–Ω–∏)
  - [üîü –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–∏–º–∏—Ç–∏–≤–æ–≤](#-—Ç–∞–±–ª–∏—Ü–∞-–ø—Ä–∏–º–∏—Ç–∏–≤–æ–≤)

**[‚¨Ü –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≥–ª–∞–≤–Ω–æ–π](../index.md)**

---

## 1Ô∏è‚É£ –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è

- **–ü—Ä–∏–º–∏—Ç–∏–≤—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏** –Ω—É–∂–Ω—ã –¥–ª—è:

  - **–ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≥–æ–Ω–æ–∫ –¥–∞–Ω–Ω—ã—Ö (race conditions)**.
  - **–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–±—â–∏–º —Ä–µ—Å—É—Ä—Å–∞–º**.
  - **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏** (thread coordination).

- –í .NET –µ—Å—Ç—å **–Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ä–æ–≤–Ω–µ–π –ø—Ä–∏–º–∏—Ç–∏–≤–æ–≤**: –æ—Ç –ø—Ä–æ—Å—Ç—ã—Ö –¥–æ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö, –≤–∫–ª—é—á–∞—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã.

---

## 2Ô∏è‚É£ `lock` (Monitor)

- –°–∞–º—ã–π –±–∞–∑–æ–≤—ã–π —Å–ø–æ—Å–æ–± —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.
- –°–∏–Ω—Ç–∞–∫—Å–∏—Å:

```csharp
private readonly object _lock = new object();

lock(_lock)
{
    // –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–∫—Ü–∏—è
}
```

- –ü–æ–¥ –∫–∞–ø–æ—Ç–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **`Monitor.Enter` / `Monitor.Exit`**.
- –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

  - –ü–æ–∑–≤–æ–ª—è–µ—Ç **—Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–º—É –ø–æ—Ç–æ–∫—É** –≤–æ–π—Ç–∏ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é —Å–µ–∫—Ü–∏—é.
  - **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è**: –æ–¥–∏–Ω –ø–æ—Ç–æ–∫ –º–æ–∂–µ—Ç –≤–æ–π—Ç–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑.
  - –í —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å `Monitor.Wait()` –∏ `Monitor.Pulse()` –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å —É—Å–ª–æ–≤–Ω—ã–µ –æ–∂–∏–¥–∞–Ω–∏—è.

---

## 3Ô∏è‚É£ `Mutex` (System.Threading.Mutex)

- **–ú–µ–∂–ø—Ä–æ—Ü–µ—Å—Å–Ω—ã–π –ø—Ä–∏–º–∏—Ç–∏–≤**: –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç–æ–∫–æ–≤ **–º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏**.
- –ü—Ä–∏–º–µ—Ä:

```csharp
Mutex mutex = new Mutex();
mutex.WaitOne(); // –∑–∞—Ö–≤–∞—Ç
try
{
    // –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–∫—Ü–∏—è
}
finally
{
    mutex.ReleaseMutex();
}
```

- –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

  - –ë–æ–ª–µ–µ –¥–æ—Ä–æ–≥–æ–π, —á–µ–º `lock`.
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–¥–∫–æ –¥–ª—è –ø–æ—Ç–æ–∫–æ–≤ –≤ –æ–¥–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ; —á–∞—â–µ –¥–ª—è –º–µ–∂–ø—Ä–æ—Ü–µ—Å—Å–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.
  - –ú–æ–∂–µ—Ç –±—ã—Ç—å **named** –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤.

---

## 4Ô∏è‚É£ `Semaphore` –∏ `SemaphoreSlim`

### Semaphore

- –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤**, –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞—Ö–æ–¥—è—â–∏—Ö –≤ —Å–µ–∫—Ü–∏—é.
- –ü—Ä–∏–º–µ—Ä:

```csharp
Semaphore sem = new Semaphore(2, 5); // –º–∞–∫—Å–∏–º—É–º 2 –ø–æ—Ç–æ–∫–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
sem.WaitOne();
// –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–∫—Ü–∏—è
sem.Release();
```

### SemaphoreSlim

- –ë–æ–ª–µ–µ –ª—ë–≥–∫–∏–π, —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç **–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã**:

  - `WaitAsync()`

- –û—Ç–ª–∏—á–∏–µ –æ—Ç –æ–±—ã—á–Ω–æ–≥–æ Semaphore:

  - –ë—ã—Å—Ç—Ä–µ–µ, –º–µ–Ω—å—à–µ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤.
  - –ù–µ –º–µ–∂–ø—Ä–æ—Ü–µ—Å—Å–Ω—ã–π.

---

## 5Ô∏è‚É£ `AutoResetEvent` –∏ `ManualResetEvent`

- **–°–æ–±—ã—Ç–∏—è (events)** –¥–ª—è —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏.
- **AutoResetEvent**

  - –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –æ–¥–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞.
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **–æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**.

- **ManualResetEvent**

  - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–∏–≥–Ω–∞–ª –¥–æ —è–≤–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞ (`Reset()`).
  - –ú–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –ø–æ—Å–ª–µ —Å–∏–≥–Ω–∞–ª–∞.

- –ü—Ä–∏–º–µ—Ä:

```csharp
AutoResetEvent are = new AutoResetEvent(false);

Thread t = new Thread(() =>
{
    Console.WriteLine("Waiting...");
    are.WaitOne(); // –∂–¥—ë—Ç —Å–∏–≥–Ω–∞–ª–∞
    Console.WriteLine("Signaled!");
});

t.Start();
Thread.Sleep(1000);
are.Set(); // –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–∞
```

---

## 6Ô∏è‚É£ `Monitor.Wait()` / `Monitor.Pulse()` / `PulseAll()`

- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **–≤ —Å–æ—á–µ—Ç–∞–Ω–∏–∏ —Å lock/Monitor**.
- `Wait()` ‚Äî –ø–æ—Ç–æ–∫ –∂–¥—ë—Ç —Å–∏–≥–Ω–∞–ª–∞, –æ—Ç–ø—É—Å–∫–∞—è lock.
- `Pulse()` ‚Äî —Å–∏–≥–Ω–∞–ª –æ–¥–Ω–æ–º—É –æ–∂–∏–¥–∞—é—â–µ–º—É –ø–æ—Ç–æ–∫—É.
- `PulseAll()` ‚Äî —Å–∏–≥–Ω–∞–ª –≤—Å–µ–º –æ–∂–∏–¥–∞—é—â–∏–º –ø–æ—Ç–æ–∫–∞–º.
- –ü—Ä–∏–º–µ—Ä:

```csharp
lock(_lock)
{
    while(!condition) Monitor.Wait(_lock);
    // –æ–±—Ä–∞–±–æ—Ç–∫–∞
    Monitor.Pulse(_lock);
}
```

- –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **producer/consumer pattern**.

---

## 7Ô∏è‚É£ ReaderWriterLockSlim

- –ü–æ–∑–≤–æ–ª—è–µ—Ç:

  - **–ú–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è —á—Ç–µ–Ω–∏—è**.
  - **–û–¥–∏–Ω –ø–æ—Ç–æ–∫ –¥–ª—è –∑–∞–ø–∏—Å–∏**.

- –ü—Ä–∏–º–µ—Ä:

```csharp
ReaderWriterLockSlim rwLock = new ReaderWriterLockSlim();

// –ß—Ç–µ–Ω–∏–µ
rwLock.EnterReadLock();
try { /* —á—Ç–µ–Ω–∏–µ */ } finally { rwLock.ExitReadLock(); }

// –ó–∞–ø–∏—Å—å
rwLock.EnterWriteLock();
try { /* –∑–∞–ø–∏—Å—å */ } finally { rwLock.ExitWriteLock(); }
```

- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–∏ —á–∞—Å—Ç—ã—Ö —á—Ç–µ–Ω–∏—è—Ö –∏ —Ä–µ–¥–∫–∏—Ö –∑–∞–ø–∏—Å—è—Ö.

---

## 8Ô∏è‚É£ Interlocked

- –ü—Ä–æ—Å—Ç—ã–µ **–∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** —Å —á–∏—Å–ª–∞–º–∏.
- –ú–µ—Ç–æ–¥—ã:

  - `Interlocked.Increment(ref x)`
  - `Interlocked.Decrement(ref x)`
  - `Interlocked.Add(ref x, value)`
  - `Interlocked.Exchange(ref x, newValue)`
  - `Interlocked.CompareExchange(ref x, newValue, comparand)`

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **–º–∏–∫—Ä–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫**.
- –ë—ã—Å—Ç—Ä–æ, –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –Ω–∞ –ø—Ä–æ—Å—Ç—ã–µ —Ç–∏–ø—ã (`int`, `long`, `IntPtr`).

---

## 9Ô∏è‚É£ –ö–∞–≤–µ—Ä–∑–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏ –ø–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏

1. **lock vs Monitor**

   - `lock` ‚Äî —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–π —Å–∞—Ö–∞—Ä –¥–ª—è `Monitor.Enter/Exit`.
   - –ù—É–∂–Ω–æ **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–∞—Ö** (–≤–æ–∑–º–æ–∂–Ω—ã deadlock/–≤–Ω–µ—à–Ω–∏–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞).

2. **Mutex vs Semaphore**

   - Mutex ‚Üí –¥–æ—Ä–æ–≥–æ, –º–µ–∂–ø—Ä–æ—Ü–µ—Å—Å–Ω—ã–π.
   - SemaphoreSlim ‚Üí –ª—ë–≥–∫–∏–π, –¥–ª—è –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.

3. **Deadlock**

   - –î–≤–∞ –ø–æ—Ç–æ–∫–∞ –∂–¥—É—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ ‚Üí –≤–∑–∞–∏–º–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞.
   - –ß–∞—Å—Ç–æ –ø—Ä–∏ nested lock / –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–∏–º–∏—Ç–∏–≤–æ–≤.

4. **Async / await**

   - –î–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤:

     - `SemaphoreSlim.WaitAsync()`
     - `AsyncLock` (–æ—Ç —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫)

   - `lock` –Ω–µ —Å–æ–≤–º–µ—Å—Ç–∏–º —Å `await` –≤–Ω—É—Ç—Ä–∏, –Ω—É–∂–µ–Ω `AsyncLock`.

5. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**

   - `Interlocked` –±—ã—Å—Ç—Ä–µ–µ –≤—Å–µ—Ö.
   - `lock` –º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –ø—Ä–æ—â–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ.
   - `Mutex` —Å–∞–º—ã–π –¥–æ—Ä–æ–≥–æ–π.

---

## üîü –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–∏–º–∏—Ç–∏–≤–æ–≤

| –ü—Ä–∏–º–∏—Ç–∏–≤             | Scope              | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                    | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ async |
| -------------------- | ------------------ | ------------------------------ | --------------- |
| lock / Monitor       | –û–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å       | –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π, –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫   | –ù–µ—Ç             |
| Mutex                | –ú–µ–∂–ø—Ä–æ—Ü–µ—Å—Å–Ω—ã–π      | –ú–æ–∂–Ω–æ –∏–º–µ–Ω–æ–≤–∞—Ç—å, –¥–æ—Ä–æ–≥–æ–π       | –ù–µ—Ç             |
| Semaphore            | –û–¥–∏–Ω/–ú–µ–∂–ø—Ä–æ—Ü–µ—Å—Å–Ω—ã–π | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ N –ø–æ—Ç–æ–∫–æ–≤          | –ù–µ—Ç             |
| SemaphoreSlim        | –û–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å       | –õ—ë–≥–∫–∏–π, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ async        | –î–∞              |
| AutoResetEvent       | –û–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å       | –°–∏–≥–Ω–∞–ª –æ–¥–Ω–æ–º—É –ø–æ—Ç–æ–∫—É           | –ù–µ—Ç             |
| ManualResetEvent     | –û–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å       | –°–∏–≥–Ω–∞–ª –≤—Å–µ–º –ø–æ—Ç–æ–∫–∞–º            | –ù–µ—Ç             |
| ReaderWriterLockSlim | –û–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å       | –ú–Ω–æ–≥–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π, –æ–¥–∏–Ω –ø–∏—Å–∞—Ç–µ–ª—å | –ù–µ—Ç             |
| Interlocked          | –û–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å       | –ê—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —á–∏—Å–ª–∞–º–∏   | –î–∞ (—á–∞—Å—Ç–∏—á–Ω–æ)   |

---

**[‚¨Ü –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≥–ª–∞–≤–Ω–æ–π](../index.md)**

<p align="center">‚ú®Dvurechensky‚ú®</p>
