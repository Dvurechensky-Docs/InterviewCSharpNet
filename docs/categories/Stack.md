---
layout: default
title: 'üß† –ö–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ –ø–∞–º—è—Ç—å –≤ .NET (Stack, Heap, GC)?'
description: ''
author: 'Dvurechensky'
date: 2025-08-28
published: true
tags:
  - Stack
  - Heap
  - GC
  - C#
---

<h1 align="center">üß† –ö–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ –ø–∞–º—è—Ç—å –≤ .NET (Stack, Heap, GC)?</h1>
<p align="center">
    <a href="https://git.io/typing-svg"><img src="https://readme-typing-svg.demolab.com?font=Fira+Code&pause=1000&center=true&vCenter=true&width=435&lines=%D0%9F%D0%BE%D0%B2%D1%82%D0%BE%D1%80%D0%B5%D0%BD%D0%B8%D0%B5+-+%D0%BC%D0%B0%D1%82%D1%8C+%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D1%8F" alt="Typing SVG" /></a>
</p>
<p align="center">
    <a href="https://sites.google.com/view/dvurechensky" target="_blank"><img alt="Static Badge" src="https://shields.dvurechensky.pro/badge/Dvurechensky-Nikolay-blue"></a>
</p>

# ‚ú® –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [‚ú® –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ](#-–æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ)
  - [1Ô∏è‚É£ –û—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å –ø–∞–º—è—Ç–∏ –≤ .NET](#1Ô∏è‚É£-–æ—Å–Ω–æ–≤–Ω–∞—è-–º–æ–¥–µ–ª—å-–ø–∞–º—è—Ç–∏-–≤-net)
  - [2Ô∏è‚É£ Stack (–°—Ç–µ–∫)](#2Ô∏è‚É£-stack-—Å—Ç–µ–∫)
  - [3Ô∏è‚É£ Heap (–ö—É—á–∞)](#3Ô∏è‚É£-heap-–∫—É—á–∞)
  - [4Ô∏è‚É£ Garbage Collector (GC)](#4Ô∏è‚É£-garbage-collector-gc)
  - [5Ô∏è‚É£ –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–±–æ—Ä–∫–∏ –º—É—Å–æ—Ä–∞](#5Ô∏è‚É£-—Å—Ç—Ä–∞—Ç–µ–≥–∏—è-—Å–±–æ—Ä–∫–∏-–º—É—Å–æ—Ä–∞)
  - [6Ô∏è‚É£ Boxed value types](#6Ô∏è‚É£-boxed-value-types)
  - [7Ô∏è‚É£ String –∏ –ø–∞–º—è—Ç—å](#7Ô∏è‚É£-string-–∏-–ø–∞–º—è—Ç—å)
  - [8Ô∏è‚É£ –ü–æ–¥–≤–æ–¥–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ —Å–æ–±–µ—Å–µ](#8Ô∏è‚É£-–ø–æ–¥–≤–æ–¥–Ω—ã–µ-–º–æ–º–µ–Ω—Ç—ã-–∏-–≤–æ–ø—Ä–æ—Å—ã-–Ω–∞-—Å–æ–±–µ—Å–µ)
  - [9Ô∏è‚É£ –ü—Ä–∏–º–µ—Ä –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–∏](#9Ô∏è‚É£-–ø—Ä–∏–º–µ—Ä-–∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–∏)
  - [üîü –¢–∞–±–ª–∏—Ü–∞ –¥–ª—è —Å–æ–±–µ—Å–∞](#-—Ç–∞–±–ª–∏—Ü–∞-–¥–ª—è-—Å–æ–±–µ—Å–∞)

**[‚¨Ü –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≥–ª–∞–≤–Ω–æ–π](../index.md)**

---

## 1Ô∏è‚É£ –û—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å –ø–∞–º—è—Ç–∏ –≤ .NET

–í .NET –ø–∞–º—è—Ç—å –¥–µ–ª–∏—Ç—Å—è –Ω–∞ **–¥–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏**:

| –û–±–ª–∞—Å—Ç—å          | –ß—Ç–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è                                         | –ö—Ç–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç          | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                                                                                    |
| ---------------- | ---------------------------------------------------- | ---------------------- | ---------------------------------------------------------------------------------------------- |
| **Stack (—Å—Ç–µ–∫)** | –õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–±—ä–µ–∫—Ç—ã, value types | –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä / CLR       | –ë—ã—Å—Ç—Ä–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ/–æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ, LIFO, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä                                      |
| **Heap (–∫—É—á–∞)**  | –û–±—ä–µ–∫—Ç—ã reference type, boxed value type             | GC (Garbage Collector) | –î–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é —á–µ—Ä–µ–∑ —Å–±–æ—Ä–∫—É –º—É—Å–æ—Ä–∞, –¥–æ—Ä–æ–∂–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ/–æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ |

---

## 2Ô∏è‚É£ Stack (–°—Ç–µ–∫)

- **–•—Ä–∞–Ω–∏—Ç:**

  - –õ–æ–∫–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ value types (`int`, `struct`).
  - –°—Å—ã–ª–∫–∏ –Ω–∞ –æ–±—ä–µ–∫—Ç—ã reference type.

- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

  - LIFO (Last In First Out) ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ—à—ë–ª, –ø–µ—Ä–≤—ã–π –≤—ã—à–µ–ª.
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ –º–µ—Ç–æ–¥–∞.
  - –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

- **–ü—Ä–∏–º–µ—Ä:**

  ```csharp
  void Foo()
  {
      int a = 10; // –Ω–∞ —Å—Ç–µ–∫–µ
      object obj = new object(); // —Å—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç–µ–∫, –æ–±—ä–µ–∫—Ç –≤ –∫—É—á–µ
  } // —Å—Ç–µ–∫ –æ—á–∏—â–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ Foo()
  ```

---

## 3Ô∏è‚É£ Heap (–ö—É—á–∞)

- **–•—Ä–∞–Ω–∏—Ç:**

  - –û–±—ä–µ–∫—Ç—ã reference type (`class`, `string`, –º–∞—Å—Å–∏–≤—ã).
  - Value type, –µ—Å–ª–∏ –æ–Ω–∏ **—É–ø–∞–∫–æ–≤–∞–Ω—ã (boxed)**.

- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

  - GC –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –ø–∞–º—è—Ç—å.
  - –ú–µ–¥–ª–µ–Ω–Ω–µ–µ, —á–µ–º —Å—Ç–µ–∫.
  - –ù–µ LIFO, –æ–±—ä–µ–∫—Ç—ã –∂–∏–≤—É—Ç, –ø–æ–∫–∞ –Ω–∞ –Ω–∏—Ö –µ—Å—Ç—å —Å—Å—ã–ª–∫–∏.

- **–ü—Ä–∏–º–µ—Ä:**

  ```csharp
  class Person { public string Name; }
  var p = new Person(); // –æ–±—ä–µ–∫—Ç –≤ –∫—É—á–µ, p –Ω–∞ —Å—Ç–µ–∫–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Å—ã–ª–∫—É
  ```

---

## 4Ô∏è‚É£ Garbage Collector (GC)

- **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**

  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –ø–∞–º—è—Ç—å, –∫–æ–≥–¥–∞ –æ–±—ä–µ–∫—Ç—ã –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.
  - –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤.

- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

  - **Generation 0** ‚Äî –º–æ–ª–æ–¥—ã–µ –æ–±—ä–µ–∫—Ç—ã, –±—ã—Å—Ç—Ä–æ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è.
  - **Generation 1** ‚Äî –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã.
  - **Generation 2** ‚Äî –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏–µ –æ–±—ä–µ–∫—Ç—ã.
  - **Large Object Heap (LOH)** ‚Äî –æ–±—ä–µ–∫—Ç—ã >85 000 –±–∞–π—Ç, —Å–æ–±–∏—Ä–∞—é—Ç—Å—è —Ä–µ–∂–µ.

- **–¢—Ä–∏–≥–≥–µ—Ä—ã —Å–±–æ—Ä–∫–∏:**

  - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –ø–∞–º—è—Ç–∏.
  - –ó–∞–¥–∞–Ω–∏—è —Å–±–æ—Ä–∫–∏ —á–µ—Ä–µ–∑ `GC.Collect()` (—Ä–µ–¥–∫–æ –∏ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è).

---

## 5Ô∏è‚É£ –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–±–æ—Ä–∫–∏ –º—É—Å–æ—Ä–∞

1. **Mark (–ü–æ–º–µ—Ç–∏—Ç—å)**

   - GC –æ—Ç–º–µ—á–∞–µ—Ç –≤—Å–µ –∂–∏–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã (–∫–æ—Ç–æ—Ä—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ —Å—Å—ã–ª–∫–∏).

2. **Sweep (–û—á–∏—Å—Ç–∏—Ç—å)**

   - –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –ø–∞–º—è—Ç—å –¥–ª—è –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤.

3. **Compact (–ö–æ–º–ø–∞–∫—Ç–∞—Ü–∏—è)**

   - –£–ø–ª–æ—Ç–Ω—è–µ—Ç –∫—É—á—É, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏—é.

4. **Generation promotion**

   - –ï—Å–ª–∏ –æ–±—ä–µ–∫—Ç –ø–µ—Ä–µ–∂–∏–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–±–æ—Ä–æ–∫ ‚Üí –ø–æ–≤—ã—à–∞–µ—Ç—Å—è –≤ –ø–æ–∫–æ–ª–µ–Ω–∏–∏ (0 ‚Üí 1 ‚Üí 2).

---

## 6Ô∏è‚É£ Boxed value types

- Value type, –ø–æ–º–µ—â—ë–Ω–Ω—ã–π –≤ –æ–±—ä–µ–∫—Ç:

  - –ü–æ—è–≤–ª—è–µ—Ç—Å—è **–Ω–∞ –∫—É—á–µ**.
  - GC —É–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º.

- –ü—Ä–∏–º–µ—Ä:

  ```csharp
  int x = 10;
  object obj = x; // boxing
  int y = (int)obj; // unboxing
  ```

---

## 7Ô∏è‚É£ String –∏ –ø–∞–º—è—Ç—å

- **Immutable reference type**.
- –•—Ä–∞–Ω–∏—Ç—Å—è –≤ –∫—É—á–µ.
- **String interning** ‚Äî –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ª–∏—Ç–µ—Ä–∞–ª—ã –º–æ–≥—É—Ç —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç.
- –õ—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ–∑–¥–∞—ë—Ç **–Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç** –≤ –∫—É—á–µ.

---

## 8Ô∏è‚É£ –ü–æ–¥–≤–æ–¥–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏ –≤–æ–ø—Ä–æ—Å—ã –Ω–∞ —Å–æ–±–µ—Å–µ

1. **Stack vs Heap**

   - –ü–æ—á–µ–º—É value type –Ω–∞ —Å—Ç–µ–∫–µ? –ü–æ—á–µ–º—É reference type –Ω–∞ –∫—É—á–µ?
   - –ö–∞–∫ —Å—Ç–µ–∫ –æ—á–∏—â–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∞ heap ‚Äî —á–µ—Ä–µ–∑ GC?

2. **Boxing / Unboxing**

   - –ö–∞–∫ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –ø–∞–º—è—Ç—å?
   - –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è —É–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–π value type?

3. **Generations**

   - –ü–æ—á–µ–º—É –º–æ–ª–æ–¥—ã–µ –æ–±—ä–µ–∫—Ç—ã —Å–æ–±–∏—Ä–∞—é—Ç—Å—è —á–∞—â–µ?
   - –ß—Ç–æ —Ç–∞–∫–æ–µ LOH?

4. **GC.Collect()**

   - –ú–æ–∂–Ω–æ –ª–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –≤—ã–∑–≤–∞—Ç—å GC? –ö–æ–≥–¥–∞ —ç—Ç–æ –æ–ø—Ä–∞–≤–¥–∞–Ω–æ?

5. **Memory leaks**

   - –ö–∞–∫ –º–æ–∂–Ω–æ –¥–æ–ø—É—Å—Ç–∏—Ç—å —É—Ç–µ—á–∫—É –ø–∞–º—è—Ç–∏ –≤ managed —Å—Ä–µ–¥–µ? (–°–æ–±—ã—Ç–∏—è, —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏)

6. **Allocation speed**

   - Stack –±—ã—Å—Ç—Ä–µ–µ heap?
   - –ü–æ—á–µ–º—É?

7. **Reference counting vs tracing GC**

   - .NET –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **tracing GC** (–Ω–µ –ø–æ–¥—Å—á–µ—Ç —Å—Å—ã–ª–æ–∫), –≤–æ–ø—Ä–æ—Å—ã –æ —Ü–∏–∫–ª–∞—Ö —Å—Å—ã–ª–æ–∫.

8. **Pinned objects**

   - –î–ª—è interop —Å unmanaged –∫–æ–¥–æ–º (`fixed`, `GCHandle`).

---

## 9Ô∏è‚É£ –ü—Ä–∏–º–µ—Ä –∏–ª–ª—é—Å—Ç—Ä–∞—Ü–∏–∏

```csharp
class Person { public string Name; }

void Foo()
{
    int a = 5;          // stack
    Person p = new();   // p —Å—Å—ã–ª–∫–∞ –Ω–∞ stack, –æ–±—ä–µ–∫—Ç –≤ heap
    object o = a;       // boxing -> heap
}

Foo(); // a –∏ p –∏—Å—á–µ–∑–∞—é—Ç —Å–æ —Å—Ç–µ–∫–∞, –æ–±—ä–µ–∫—Ç Person –∂–¥—ë—Ç GC
```

---

## üîü –¢–∞–±–ª–∏—Ü–∞ –¥–ª—è —Å–æ–±–µ—Å–∞

| –ü–æ–Ω—è—Ç–∏–µ                        | –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è | –ö—Ç–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                     |
| ------------------------------ | ------------ | ------------- | ------------------------------- |
| Value type (int, struct)       | Stack        | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ | –ö–æ–ø–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–∏     |
| Reference type (class, string) | Heap         | GC            | –°—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç–µ–∫                  |
| Boxed value type               | Heap         | GC            | –ü—Ä–µ–≤—Ä–∞—â–µ–Ω–∏–µ value type –≤ object |
| LOH                            | Heap         | GC            | –î–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤ >85KB      |
| String                         | Heap         | GC, interning | Immutable                       |
| GC Gen 0                       | Heap         | GC            | –ú–æ–ª–æ–¥—ã–µ –æ–±—ä–µ–∫—Ç—ã, —á–∞—Å—Ç–∞—è —Å–±–æ—Ä–∫–∞  |
| GC Gen 1                       | Heap         | GC            | –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã           |
| GC Gen 2                       | Heap         | GC            | –î–æ–ª–≥–æ–∂–∏–≤—É—â–∏–µ –æ–±—ä–µ–∫—Ç—ã            |

---

**[‚¨Ü –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≥–ª–∞–≤–Ω–æ–π](../index.md)**

<p align="center">‚ú®Dvurechensky‚ú®</p>
