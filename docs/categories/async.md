---
layout: default
title: '‚ö° –ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω—ã –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –∏ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å –≤ .NET?'
description: ''
author: 'Dvurechensky'
date: 2025-08-28
published: true
tags:
  - Thread
  - Task
  - Async
  - await
  - C#
---

<p align="center">
    <a href="https://git.io/typing-svg"><img src="https://readme-typing-svg.demolab.com?font=Fira+Code&pause=1000&center=true&vCenter=true&width=435&lines=%D0%9F%D0%BE%D0%B2%D1%82%D0%BE%D1%80%D0%B5%D0%BD%D0%B8%D0%B5+-+%D0%BC%D0%B0%D1%82%D1%8C+%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D1%8F" alt="Typing SVG" /></a>
</p>
<p align="center">
    <a href="https://sites.google.com/view/dvurechensky" target="_blank"><img alt="Static Badge" src="https://shields.dvurechensky.pro/badge/Dvurechensky-Nikolay-blue"></a>
</p>

# ‚ú® –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [‚ú® –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ](#-–æ–≥–ª–∞–≤–ª–µ–Ω–∏–µ)
  - [1Ô∏è‚É£ –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è](#1Ô∏è‚É£-–æ—Å–Ω–æ–≤–Ω—ã–µ-–ø–æ–Ω—è—Ç–∏—è)
  - [2Ô∏è‚É£ –ü–æ—Ç–æ–∫–∏ (Thread)](#2Ô∏è‚É£-–ø–æ—Ç–æ–∫–∏-thread)
  - [3Ô∏è‚É£ ThreadPool](#3Ô∏è‚É£-threadpool)
  - [4Ô∏è‚É£ Tasks (Task Parallel Library, TPL)](#4Ô∏è‚É£-tasks-task-parallel-library-tpl)
  - [5Ô∏è‚É£ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å (`async` / `await`)](#5Ô∏è‚É£-–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å-async--await)
  - [6Ô∏è‚É£ –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å vs –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å](#6Ô∏è‚É£-–º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å-vs-–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å)
  - [7Ô∏è‚É£ –ü—Ä–∏–º–∏—Ç–∏–≤—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏](#7Ô∏è‚É£-–ø—Ä–∏–º–∏—Ç–∏–≤—ã-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)
  - [8Ô∏è‚É£ –ö–∞–≤–µ—Ä–∑–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏ –≤–æ–ø—Ä–æ—Å—ã](#8Ô∏è‚É£-–∫–∞–≤–µ—Ä–∑–Ω—ã–µ-–º–æ–º–µ–Ω—Ç—ã-–∏-–≤–æ–ø—Ä–æ—Å—ã)
  - [9Ô∏è‚É£ –ü—Ä–∏–º–µ—Ä: CPU-bound vs IO-bound](#9Ô∏è‚É£-–ø—Ä–∏–º–µ—Ä-cpu-bound-vs-io-bound)
  - [üîü –¢–∞–±–ª–∏—Ü–∞: –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å vs –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å](#-—Ç–∞–±–ª–∏—Ü–∞-–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å-vs-–º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å)

**[‚¨Ü –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≥–ª–∞–≤–Ω–æ–π](../index.md)**

---

## 1Ô∏è‚É£ –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è

| –ü–æ–Ω—è—Ç–∏–µ                    | –û–ø–∏—Å–∞–Ω–∏–µ                                                                    |
| -------------------------- | --------------------------------------------------------------------------- |
| **Thread (–ü–æ—Ç–æ–∫)**         | –ù–µ–∑–∞–≤–∏—Å–∏–º—ã–π –ø–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–∞ CPU.                                        |
| **Task (–ó–∞–¥–∞—á–∞)**          | –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è —Ä–∞–±–æ—Ç—ã, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏–ª–∏ –Ω–∞ –ø–æ—Ç–æ–∫–µ.      |
| **Async/await**            | –°–∏–Ω—Ç–∞–∫—Å–∏—Å –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π `Task`.           |
| **ThreadPool**             | –ü—É–ª –ø–æ—Ç–æ–∫–æ–≤, —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π CLR, –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤.         |
| **SynchronizationContext** | –ö–æ–Ω—Ç–µ–∫—Å—Ç, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –ø–æ—Å–ª–µ await (UI, ASP.NET). |

---

## 2Ô∏è‚É£ –ü–æ—Ç–æ–∫–∏ (Thread)

- –ö–ª–∞—Å—Å `System.Threading.Thread`
- –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –≤—Ä—É—á–Ω—É—é:

```csharp
Thread t = new Thread(() => Console.WriteLine("Hello"));
t.Start();
```

- –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

  - –ö–∞–∂–¥—ã–π –ø–æ—Ç–æ–∫ –∏–º–µ–µ—Ç —Å–≤–æ–π —Å—Ç–µ–∫ (stack), heap –æ–±—â–∏–π.
  - –ü–æ—Ç–æ–∫–∏ –¥–æ—Ä–æ–∂–µ –ø–æ —Ä–µ—Å—É—Ä—Å–∞–º, —á–µ–º –∑–∞–¥–∞—á–∏.
  - –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–¥–µ–ª—è–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

---

## 3Ô∏è‚É£ ThreadPool

- `ThreadPool.QueueUserWorkItem` / `Task.Run()`
- –ü–ª—é—Å—ã:

  - –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤
  - –ú–µ–Ω—å—à–µ –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤

- –ú–∏–Ω—É—Å—ã:

  - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ—Ç–æ–∫–æ–≤
  - –ù–µ–ª—å–∑—è —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á –Ω–∞–ø—Ä—è–º—É—é

---

## 4Ô∏è‚É£ Tasks (Task Parallel Library, TPL)

- –ö–ª–∞—Å—Å `Task` ‚Äî –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –∏–ª–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É
- –ü—Ä–∏–º–µ—Ä:

```csharp
Task t = Task.Run(() => DoWork());
await t; // –æ–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
```

- –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

  - `Task` ‚Äî –ª–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è
  - –ú–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç (`Task<T>`)
  - –ü–æ–¥ –∫–∞–ø–æ—Ç–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ThreadPool

---

## 5Ô∏è‚É£ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å (`async` / `await`)

- –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–∏—Å–∞—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥ **–∫–∞–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π**
- –ü—Ä–∏–º–µ—Ä:

```csharp
async Task<int> GetDataAsync()
{
    var result = await HttpClient.GetStringAsync("https://example.com");
    return result.Length;
}
```

- –ú–µ—Ö–∞–Ω–∏–∑–º:

  1. –ú–µ—Ç–æ–¥ —Å `async` –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –≤ **state machine**.
  2. –ü—Ä–∏ `await` –º–µ—Ç–æ–¥ **–ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è**, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤—ã–∑—ã–≤–∞—é—â–µ–º—É.
  3. –ö–æ–≥–¥–∞ –∑–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –Ω–∞ **SynchronizationContext**.

---

## 6Ô∏è‚É£ –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å vs –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å

| –ü–æ–Ω—è—Ç–∏–µ         | –ú–µ—Ö–∞–Ω–∏–∑–º                   | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ                              |
| --------------- | -------------------------- | --------------------------------------- |
| –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å | –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ CPU      | CPU-bound –∑–∞–¥–∞—á–∏ (–≤—ã—á–∏—Å–ª–µ–Ω–∏—è)           |
| –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å   | –ù–µ –±–ª–æ–∫–∏—Ä—É—é—â–µ–µ –æ–∂–∏–¥–∞–Ω–∏–µ IO | IO-bound –∑–∞–¥–∞—á–∏ (–∑–∞–ø—Ä–æ—Å—ã –∫ —Å–µ—Ç–∏/—Ñ–∞–π–ª–∞–º) |

- –í–∞–∂–Ω–æ: **await –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫!**
- CPU-bound ‚Üí –ª—É—á—à–µ Task + ThreadPool / Parallel.
- IO-bound ‚Üí async/await, –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –ø–æ—Ç–æ–∫ –¥–ª—è –¥—Ä—É–≥–∏—Ö –∑–∞–¥–∞—á.

---

## 7Ô∏è‚É£ –ü—Ä–∏–º–∏—Ç–∏–≤—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

- –î–ª—è –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –≥–æ–Ω–æ–∫:

  - `lock` ‚Äî –ø—Ä–æ—Å—Ç–æ–π –º–æ–Ω–∏—Ç–æ—Ä
  - `Mutex` ‚Äî –º–µ–∂–ø—Ä–æ—Ü–µ—Å—Å–Ω—ã–π
  - `Semaphore` / `SemaphoreSlim` ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∏—Å–ª–∞ –ø–æ—Ç–æ–∫–æ–≤
  - `Monitor.Enter/Exit` ‚Äî –≤—Ä—É—á–Ω—É—é
  - `ReaderWriterLockSlim` ‚Äî —á—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å
  - `Interlocked` ‚Äî –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

- Async-friendly:

  - `SemaphoreSlim.WaitAsync()`

---

## 8Ô∏è‚É£ –ö–∞–≤–µ—Ä–∑–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏ –≤–æ–ø—Ä–æ—Å—ã

1. **await vs Thread**

   - await –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –ø–æ—Ç–æ–∫, –ø–æ—Ç–æ–∫ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è.
   - Task.Run —Å–æ–∑–¥–∞—ë—Ç —Ä–∞–±–æ—Ç—É –≤ –ø—É–ª–µ –ø–æ—Ç–æ–∫–æ–≤.

2. **SynchronizationContext**

   - UI-thread –∏–ª–∏ ASP.NET context –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ await.

3. **Deadlocks**

   - –ß–∞—Å—Ç–æ –ø—Ä–∏ `.Result` –∏–ª–∏ `.Wait()` –Ω–∞ UI –∏–ª–∏ ASP.NET –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è deadlock.

4. **Thread safety**

   - –õ—é–±—ã–µ shared data ‚Üí lock –∏–ª–∏ concurrent collections.

5. **Task vs Thread**

   - Task ‚Äî –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π, –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫ –∏–∑ –ø—É–ª–∞.
   - Thread ‚Äî —Ç—è–∂–µ–ª—ã–π, –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å—Ç–µ–∫.

6. **ConfigureAwait(false)**

   - –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ await –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –Ω–∞ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ ‚Üí –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç deadlock, –ø–æ–≤—ã—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.

7. **Async all the way**

   - –ï—Å–ª–∏ –º–µ—Ç–æ–¥ async –≤—ã–∑—ã–≤–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –±–ª–æ–∫–∏—Ä—É—é—â–∏–π –∫–æ–¥, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–∞–¥–∞–µ—Ç.

8. **CancellationToken**

   - –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–º–µ–Ω—è—Ç—å –∑–∞–¥–∞—á–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ.

---

## 9Ô∏è‚É£ –ü—Ä–∏–º–µ—Ä: CPU-bound vs IO-bound

**CPU-bound:**

```csharp
var tasks = new Task[4];
for(int i=0;i<4;i++)
    tasks[i] = Task.Run(() => ComputeHeavy());
Task.WaitAll(tasks);
```

**IO-bound:**

```csharp
async Task FetchDataAsync()
{
    var data = await httpClient.GetStringAsync("https://example.com");
    Console.WriteLine(data);
}
await FetchDataAsync(); // –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫
```

---

## üîü –¢–∞–±–ª–∏—Ü–∞: –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å vs –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞          | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å                   | –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å                   |
| ----------------------- | ------------------------------- | --------------------------------- |
| –¶–µ–ª—å                    | –ù–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫ –ø—Ä–∏ IO     | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CPU –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ      |
| –ü–æ—Ç–æ–∫                   | –û–¥–∏–Ω –ø–æ—Ç–æ–∫, –º–æ–∂–µ—Ç –æ—Å–≤–æ–±–æ–∂–¥–∞—Ç—å—Å—è | –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ    |
| –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ           | `async/await`, `Task`           | `Thread`, `ThreadPool`, `Task`    |
| –ü—Ä–∏–º–∏—Ç–∏–≤—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ | SemaphoreSlim, async locks      | lock, Mutex, Monitor, Interlocked |
| Deadlock                | –í–æ–∑–º–æ–∂–µ–Ω –ø—Ä–∏ sync-over-async    | –í–æ–∑–º–æ–∂–µ–Ω –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º lock    |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å      | –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –¥–ª—è IO              | –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –¥–ª—è CPU-heavy         |

---

**[‚¨Ü –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≥–ª–∞–≤–Ω–æ–π](../index.md)**

<p align="center">‚ú®Dvurechensky‚ú®</p>
